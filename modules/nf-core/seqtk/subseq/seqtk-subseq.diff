Changes in component 'nf-core/seqtk/subseq'
'modules/nf-core/seqtk/subseq/environment.yml' is unchanged
Changes in 'seqtk/subseq/meta.yml':
--- modules/nf-core/seqtk/subseq/meta.yml
+++ modules/nf-core/seqtk/subseq/meta.yml
@@ -1,54 +1,32 @@
 name: seqtk_subseq
 description: Select only sequences that match the filtering condition
 keywords:
-  - filtering
-  - selection
-  - fastx
+  - filtering,selection
 tools:
   - seqtk:
-      description: Seqtk is a fast and lightweight tool for processing sequences in
-        the FASTA or FASTQ format
+      description: Seqtk is a fast and lightweight tool for processing sequences in the FASTA or FASTQ format
       homepage: https://github.com/lh3/seqtk
       documentation: https://docs.csc.fi/apps/seqtk/
       tool_dev_url: https://github.com/lh3/seqtk
       licence: ["MIT"]
-      identifier: biotools:seqtk
 input:
-  - - meta:
-        type: map
-        description: |
-          Groovy Map containing sample information
-          e.g. [ id:'test' ]
-    - sequences:
-        type: file
-        description: FASTQ/FASTA file
-        pattern: "*.{fq,fq.gz,fa,fa.gz}"
-        ontologies:
-          - edam: http://edamontology.org/format_1930 # FASTQ
+  - sequences:
+      type: file
+      description: FASTQ/FASTA file
+      pattern: "*.{fq,fq.gz,fa,fa.gz}"
   - filter_list:
       type: file
       description: BED file or a text file with a list of sequence names
       pattern: "*.{bed,lst}"
-      ontologies: []
 output:
-  sequences:
-    - - meta:
-          type: file
-          description: FASTQ/FASTA file
-          pattern: "*.{fq.gz,fa.gz}"
-          ontologies: []
-      - "*.gz":
-          type: file
-          description: FASTQ/FASTA file
-          pattern: "*.{fq.gz,fa.gz}"
-          ontologies: []
-  versions:
-    - versions.yml:
-        type: file
-        description: File containing software versions
-        pattern: "versions.yml"
-        ontologies:
-          - edam: http://edamontology.org/format_3750 # YAML
+  - versions:
+      type: file
+      description: File containing software versions
+      pattern: "versions.yml"
+  - sequences:
+      type: file
+      description: FASTQ/FASTA file
+      pattern: "*.{fq.gz,fa.gz}"
 authors:
   - "@sidorov-si"
 maintainers:

Changes in 'seqtk/subseq/main.nf':
--- modules/nf-core/seqtk/subseq/main.nf
+++ modules/nf-core/seqtk/subseq/main.nf
@@ -1,6 +1,6 @@
 process SEQTK_SUBSEQ {
     tag "$sequences"
-    label 'process_single'
+    label 'very_light'
 
     conda "${moduleDir}/environment.yml"
     container "${ workflow.containerEngine == 'singularity' && !task.ext.singularity_pull_docker_container ?
@@ -8,12 +8,12 @@
         'biocontainers/seqtk:1.4--he4a0461_1' }"
 
     input:
-    tuple val(meta), path(sequences)
-    path filter_list
+    tuple val(meta), path(filter_list), path(sequences)
 
     output:
-    tuple val(meta), path("*.gz"),  emit: sequences
-    path "versions.yml",            emit: versions
+    tuple val(meta), val(var_region), path("*.gz"), emit: extracted_var_out
+    tuple val(meta), val(var_region), path(filter_list), emit: extracted_var_path
+    path "versions.yml" , emit: versions
 
     when:
     task.ext.when == null || task.ext.when
@@ -21,32 +21,19 @@
     script:
     def args   = task.ext.args   ?: ''
     def prefix = task.ext.prefix ?: "${meta.id}"
-    def ext = "fa"
+    def ext = "fasta"
+    var_region = "${filter_list.baseName.split('\\.')[1,2].join('-')}"
     if ("$sequences" ==~ /.+\.fq|.+\.fq.gz|.+\.fastq|.+\.fastq.gz/) {
-        ext = "fq"
+        ext = "fastq"
     }
+    
     """
     seqtk \\
         subseq \\
         $args \\
         $sequences \\
         $filter_list | \\
-        gzip --no-name > ${sequences}${prefix}.${ext}.gz
-
-    cat <<-END_VERSIONS > versions.yml
-    "${task.process}":
-        seqtk: \$(echo \$(seqtk 2>&1) | sed 's/^.*Version: //; s/ .*\$//')
-    END_VERSIONS
-    """
-
-    stub:
-    def prefix = task.ext.prefix ?: "${meta.id}"
-    def ext = "fa"
-    if ("$sequences" ==~ /.+\.fq|.+\.fq.gz|.+\.fastq|.+\.fastq.gz/) {
-        ext = "fq"
-    }
-    """
-    echo "" | gzip > ${sequences}${prefix}.${ext}.gz
+        gzip --no-name > ${prefix}_${var_region}_extracted.${ext}.gz
 
     cat <<-END_VERSIONS > versions.yml
     "${task.process}":

Changes in 'seqtk/subseq/tests/main.nf.test.snap':
--- modules/nf-core/seqtk/subseq/tests/main.nf.test.snap
+++ modules/nf-core/seqtk/subseq/tests/main.nf.test.snap
@@ -1,24 +1,44 @@
 {
-    "sarscov2_subseq_fa": {
+    "seqtk/subseq patch": {
         "content": [
             {
                 "0": [
                     [
                         {
-                            "id": "test"
+                            "id": "ERR4334351"
                         },
-                        "genome.fasta.filtered.fa.gz:md5,31c95c4d686526cf002f6119bc55b2b2"
+                        "16S-V3-V4",
+                        "ERR4334351_16S-V3-V4_extracted.fastq.gz:md5,54835b74fdc2c414e970fa6a7d7c88b3"
                     ]
                 ],
                 "1": [
+                    [
+                        {
+                            "id": "ERR4334351"
+                        },
+                        "16S-V3-V4",
+                        "ERR4334351.16S.V3-V4.txt:md5,184deb4ff99714b4c71ebc9f2e75eac7"
+                    ]
+                ],
+                "2": [
                     "versions.yml:md5,cd7682f4da748ef6d083c4a4656cc1e2"
                 ],
-                "sequences": [
+                "extracted_var_out": [
                     [
                         {
-                            "id": "test"
+                            "id": "ERR4334351"
                         },
-                        "genome.fasta.filtered.fa.gz:md5,31c95c4d686526cf002f6119bc55b2b2"
+                        "16S-V3-V4",
+                        "ERR4334351_16S-V3-V4_extracted.fastq.gz:md5,54835b74fdc2c414e970fa6a7d7c88b3"
+                    ]
+                ],
+                "extracted_var_path": [
+                    [
+                        {
+                            "id": "ERR4334351"
+                        },
+                        "16S-V3-V4",
+                        "ERR4334351.16S.V3-V4.txt:md5,184deb4ff99714b4c71ebc9f2e75eac7"
                     ]
                 ],
                 "versions": [
@@ -26,28 +46,52 @@
                 ]
             }
         ],
-        "timestamp": "2024-02-22T15:56:36.155954"
+        "meta": {
+            "nf-test": "0.9.2",
+            "nextflow": "25.04.8"
+        },
+        "timestamp": "2025-11-07T15:09:57.876903"
     },
-    "sarscov2_subseq_fa_stub": {
+    "seqtk/subseq patch stub": {
         "content": [
             {
                 "0": [
                     [
                         {
-                            "id": "test"
+                            "id": "ERR4334351"
                         },
-                        "genome.fasta.filtered.fa.gz:md5,68b329da9893e34099c7d8ad5cb9c940"
+                        "16S-V3-V4",
+                        "ERR4334351_16S-V3-V4_extracted.fastq.gz:md5,54835b74fdc2c414e970fa6a7d7c88b3"
                     ]
                 ],
                 "1": [
+                    [
+                        {
+                            "id": "ERR4334351"
+                        },
+                        "16S-V3-V4",
+                        "ERR4334351.16S.V3-V4.txt:md5,184deb4ff99714b4c71ebc9f2e75eac7"
+                    ]
+                ],
+                "2": [
                     "versions.yml:md5,cd7682f4da748ef6d083c4a4656cc1e2"
                 ],
-                "sequences": [
+                "extracted_var_out": [
                     [
                         {
-                            "id": "test"
+                            "id": "ERR4334351"
                         },
-                        "genome.fasta.filtered.fa.gz:md5,68b329da9893e34099c7d8ad5cb9c940"
+                        "16S-V3-V4",
+                        "ERR4334351_16S-V3-V4_extracted.fastq.gz:md5,54835b74fdc2c414e970fa6a7d7c88b3"
+                    ]
+                ],
+                "extracted_var_path": [
+                    [
+                        {
+                            "id": "ERR4334351"
+                        },
+                        "16S-V3-V4",
+                        "ERR4334351.16S.V3-V4.txt:md5,184deb4ff99714b4c71ebc9f2e75eac7"
                     ]
                 ],
                 "versions": [
@@ -55,6 +99,10 @@
                 ]
             }
         ],
-        "timestamp": "2024-02-22T15:56:44.222329"
+        "meta": {
+            "nf-test": "0.9.2",
+            "nextflow": "25.04.8"
+        },
+        "timestamp": "2025-11-07T15:10:10.819625"
     }
 }
'modules/nf-core/seqtk/subseq/tests/ERR4334351.16S.V3-V4.txt' was created
Changes in 'seqtk/subseq/tests/main.nf.test':
--- modules/nf-core/seqtk/subseq/tests/main.nf.test
+++ modules/nf-core/seqtk/subseq/tests/main.nf.test
@@ -3,23 +3,22 @@
     name "Test Process SEQTK_SUBSEQ"
     script "modules/nf-core/seqtk/subseq/main.nf"
     process "SEQTK_SUBSEQ"
-    config "./standard.config"
 
     tag "modules"
     tag "modules_nfcore"
     tag "seqtk"
     tag "seqtk/subseq"
 
-    test("sarscov2_subseq_fa") {
+    test("seqtk/subseq patch") {
 
         when {
             process {
                 """
                 input[0] =  [
-                                [ id:'test' ],
-                                file(params.modules_testdata_base_path + 'genomics/sarscov2/genome/genome.fasta', checkIfExists: true)
+                                [ id:'ERR4334351' ],
+                                file('${projectDir}/modules/nf-core/seqtk/subseq/tests/ERR4334351.16S.V3-V4.txt', checkIfExists: true),
+                                file('${projectDir}/modules/nf-core/seqtk/subseq/tests/ERR4334351.merged.fastq', checkIfExists: true)
                             ]
-                input[1] =  file(params.modules_testdata_base_path + 'genomics/sarscov2/genome/bed/test.bed.gz', checkIfExists: true)
                 """
             }
         }
@@ -33,16 +32,16 @@
 
     }
 
-    test("sarscov2_subseq_fa_stub") {
+    test("seqtk/subseq patch stub") {
         options "-stub"
         when {
             process {
                 """
                 input[0] =  [
-                                [ id:'test' ],
-                                file(params.modules_testdata_base_path + 'genomics/sarscov2/genome/genome.fasta', checkIfExists: true)
+                                [ id:'ERR4334351' ],
+                                file('${projectDir}/modules/nf-core/seqtk/subseq/tests/ERR4334351.16S.V3-V4.txt', checkIfExists: true),
+                                file('${projectDir}/modules/nf-core/seqtk/subseq/tests/ERR4334351.merged.fastq', checkIfExists: true)
                             ]
-                input[1] =  file(params.modules_testdata_base_path + 'genomics/sarscov2/genome/bed/test.bed.gz', checkIfExists: true)
                 """
             }
         }

'modules/nf-core/seqtk/subseq/tests/ERR4334351.merged.fastq' was created
'modules/nf-core/seqtk/subseq/tests/standard.config' was removed
************************************************************
